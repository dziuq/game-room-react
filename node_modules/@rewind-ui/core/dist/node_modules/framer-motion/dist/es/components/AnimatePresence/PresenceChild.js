import*as React from"react";import{useId,useMemo}from"react";import{PresenceContext}from"../../context/PresenceContext.js";import{useConstant}from"../../utils/use-constant.js";import{PopChild}from"./PopChild.js";const PresenceChild=({children:e,initial:t,isPresent:o,onExitComplete:s,custom:n,presenceAffectsLayout:r,mode:i})=>{const c=useConstant(newChildrenMap),a=useId(),m=useMemo((()=>({id:a,initial:t,isPresent:o,custom:n,onExitComplete:e=>{c.set(e,!0);for(const e of c.values())if(!e)return;s&&s()},register:e=>(c.set(e,!1),()=>c.delete(e))})),r?void 0:[o]);return useMemo((()=>{c.forEach(((e,t)=>c.set(t,!1)))}),[o]),React.useEffect((()=>{!o&&!c.size&&s&&s()}),[o]),"popLayout"===i&&(e=React.createElement(PopChild,{isPresent:o},e)),React.createElement(PresenceContext.Provider,{value:m},e)};function newChildrenMap(){return new Map}export{PresenceChild};
