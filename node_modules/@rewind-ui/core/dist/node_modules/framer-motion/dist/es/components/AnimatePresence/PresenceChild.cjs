"use strict";var React=require("react"),PresenceContext=require("../../context/PresenceContext.cjs"),useConstant=require("../../utils/use-constant.cjs"),PopChild=require("./PopChild.cjs");function _interopNamespaceDefault(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var React__namespace=_interopNamespaceDefault(React);const PresenceChild=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:c,presenceAffectsLayout:s,mode:a})=>{const o=useConstant.useConstant(newChildrenMap),i=React.useId(),u=React.useMemo((()=>({id:i,initial:t,isPresent:n,custom:c,onExitComplete:e=>{o.set(e,!0);for(const e of o.values())if(!e)return;r&&r()},register:e=>(o.set(e,!1),()=>o.delete(e))})),s?void 0:[n]);return React.useMemo((()=>{o.forEach(((e,t)=>o.set(t,!1)))}),[n]),React__namespace.useEffect((()=>{!n&&!o.size&&r&&r()}),[n]),"popLayout"===a&&(e=React__namespace.createElement(PopChild.PopChild,{isPresent:n},e)),React__namespace.createElement(PresenceContext.PresenceContext.Provider,{value:u},e)};function newChildrenMap(){return new Map}exports.PresenceChild=PresenceChild;
