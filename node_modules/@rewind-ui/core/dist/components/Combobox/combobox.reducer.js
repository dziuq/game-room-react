import{ComboboxActionEnum}from"./Combobox.types.js";const comboboxReducer=(e,a)=>{switch(a.type){case ComboboxActionEnum.register:return Object.assign(Object.assign({},e),{options:[...e.options,{label:a.payload.label,value:a.payload.value}]});case ComboboxActionEnum.single_select:if(!a.payload.omitOnChange&&e.onChange&&e.onChange(a.payload.value),void 0===a.payload.value)return e;const n=e.selectedOptions.find((e=>e.value===a.payload.value)),s=e.options.find((e=>e.value===a.payload.value));return Object.assign(Object.assign({},e),{search:"",searching:!1,selectedOptions:n&&a.payload.toggle?[]:[s]});case ComboboxActionEnum.multi_select:const o=e.selectedOptions.find((e=>e.value===a.payload.value));let t=e.selectedOptions.filter((e=>e.value!==(null==o?void 0:o.value)));if(o&&a.payload.toggle)return!a.payload.omitOnChange&&e.onChange&&e.onChange(t.map((e=>e.value))),Object.assign(Object.assign({},e),{search:"",searching:!1,selectedOptions:t});if(o&&!a.payload.toggle)return e;const c=e.options.find((e=>e.value===a.payload.value));return t=[...e.selectedOptions,c],!a.payload.omitOnChange&&e.onChange&&e.onChange(t.map((e=>e.value))),Object.assign(Object.assign({},e),{search:"",searching:!1,selectedOptions:t});case ComboboxActionEnum.init_multi_select:const i=e.selectedOptions.map((e=>e.value)).sort(),l=a.payload.values.sort(),r=i.length===l.length;if(l.every(((e,a)=>i[a]===e))&&r)return e;const u=e.options.filter((e=>a.payload.values.includes(e.value)));return Object.assign(Object.assign({},e),{selectedOptions:u});case ComboboxActionEnum.remove_last:if(e.onChange){const a=e.selectedOptions.slice(0,-1).map((e=>e.value));e.onChange(e.multiple?a:a[0])}return Object.assign(Object.assign({},e),{search:"",searching:!1,selectedOptions:e.selectedOptions.slice(0,-1)});case ComboboxActionEnum.reset:return e.onChange&&e.onChange(null),Object.assign(Object.assign({},e),{search:"",searching:!1,selectedOptions:[]});case ComboboxActionEnum.search_start:return Object.assign(Object.assign({},e),{search:a.payload.search,searching:!0});case ComboboxActionEnum.search_reset:return Object.assign(Object.assign({},e),{search:"",searching:!1});default:return e}};export{comboboxReducer};
