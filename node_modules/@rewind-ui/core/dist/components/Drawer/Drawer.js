'use client';
import{__rest}from"tslib";import{jsxs,Fragment,jsx}from"react/jsx-runtime";import{useMergeRefs,FloatingPortal}from"@floating-ui/react";import{useFocusTrap}from"../../hooks/use-focus-trap.hook.js";import{useKeypress}from"../../hooks/use-keypress.js";import{useComponentTheme}from"../../theme/theme.context.js";import{usePropId}from"../../utils/usePropId.js";import{forwardRef,useRef,useState,useMemo,useEffect}from"react";import Overlay from"../Overlay/Overlay.js";import{twMerge}from"tailwind-merge";const defaultProps={closeOnEscape:!0,color:"white",open:!1,overlayBlur:"sm",overlayCloseOnClick:!0,overlayColor:"dark",overlayOpacity:"50",position:"right",shadow:"base"},Drawer=forwardRef(((e,r)=>{const s=useComponentTheme("Drawer"),o=Object.assign(Object.assign({},defaultProps),e),{children:t,className:a="",closeOnEscape:l,onClose:i,open:n,overlayBlur:c,overlayCloseOnClick:u,overlayColor:m,overlayOpacity:p,position:f,shadow:d}=o,y=__rest(o,["children","className","closeOnEscape","onClose","open","overlayBlur","overlayCloseOnClick","overlayColor","overlayOpacity","position","shadow"]),h=usePropId(e.id),v=useRef(null),[w,g]=useState(!1),O=useFocusTrap(w),j=useMergeRefs([v,O||null,r||null]),C=useRef(null),b=useMemo((()=>twMerge(s({className:a,position:f,shadow:d}))),[a,f,d,s]);useKeypress("Escape",l,i);const k=useMemo((()=>{switch(f){case"left":default:return["translateX(-100%)","translateX(0%)"];case"right":return["translateX(100%)","translateX(0%)"];case"top":return["translateY(-100%)","translateY(0%)"];case"bottom":return["translateY(100%)","translateY(0%)"]}}),[f]);return useEffect((()=>{const e=n?150:100,r=new KeyframeEffect(v.current,[{opacity:.75,transform:k[0],visibility:"hidden"},{opacity:1,visibility:"visible",transform:k[1]}],{duration:e,fill:"both",easing:"ease-in-out"});C.current=new Animation(r,document.timeline)}),[n,v]),useEffect((()=>{C.current&&(n?(C.current.play(),C.current.onfinish=()=>{g(!0)}):(C.current.reverse(),g(!1)))}),[n]),jsxs(Fragment,{children:[jsx(Overlay,{open:n,onClick:()=>{u&&i&&i()},blur:c,color:m,opacity:p,closeOnClick:u}),jsx(FloatingPortal,{children:jsx("div",Object.assign({id:h,role:"dialog","aria-hidden":!n,style:{opacity:0,visibility:"hidden"},ref:j,className:b},y,{children:t}))})]})}));Drawer.displayName="Drawer";export{Drawer as default};
