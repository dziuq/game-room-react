'use client';
"use strict";var tslib=require("tslib"),jsxRuntime=require("react/jsx-runtime"),ModalGroup=require("./ModalGroup/ModalGroup.cjs"),ModalGroup_context=require("./ModalGroup/ModalGroup.context.cjs"),react=require("@floating-ui/react"),useFocusTrap_hook=require("../../hooks/use-focus-trap.hook.cjs"),useKeypress=require("../../hooks/use-keypress.cjs"),theme_context=require("../../theme/theme.context.cjs"),usePropId=require("../../utils/usePropId.cjs"),React=require("react"),Overlay=require("../Overlay/Overlay.cjs"),tailwindMerge=require("tailwind-merge");const defaultProps={closeOnEscape:!0,color:"white",mode:"dialog",open:!1,overlayBlur:"sm",overlayCloseOnClick:!0,overlayColor:"dark",overlayOpacity:"50",position:"top",radius:"md",shadow:"base",size:"sm"},_Modal=React.forwardRef(((e,r)=>{const s=theme_context.useComponentTheme("Modal"),o=Object.assign(Object.assign({},defaultProps),e),{children:t,className:a="",closeOnEscape:i,color:l,mode:n,onClose:c,open:u,overlayBlur:d,overlayCloseOnClick:p,overlayColor:m,overlayOpacity:y,position:f,radius:h,shadow:v,size:j}=o,x=tslib.__rest(o,["children","className","closeOnEscape","color","mode","onClose","open","overlayBlur","overlayCloseOnClick","overlayColor","overlayOpacity","position","radius","shadow","size"]),M=usePropId.usePropId(e.id),R=React.useRef(null),[g,b]=React.useState(!1),O=useFocusTrap_hook.useFocusTrap(g),C=react.useMergeRefs([R,O||null,r||null]),w=React.useRef(null),{activeModalId:k,registry:q,setRegistry:G}=ModalGroup_context.useModalGroupContext(),_=React.useMemo((()=>{if("fullscreen"===n)return"0%";switch(f){case"top":case"bottom":return"0%";default:return"-50%"}}),[f,n]);React.useEffect((()=>{if(!G||!q||!R.current)return;const e=u?[...q,R.current]:q.filter((e=>e!==R.current));if(G(e),0!==e.length&&!u&&e.length<q.length){e[e.length-1].animate([{opacity:0,transform:"translateY(-50px)",visibility:"hidden"},{opacity:1,transform:"translateY(0%)",visibility:"visible"}],{duration:150}),b(!1)}}),[u]);const E=React.useMemo((()=>tailwindMerge.twMerge(s({className:a,color:l,mode:n,position:f,radius:h,shadow:v,size:j}))),[a,l,n,f,h,v,j,s]);useKeypress.useKeypress("Escape",i,c);return React.useEffect((()=>{const e=u?"ease-in-out":"ease-out",r=u?150:100,s=new KeyframeEffect(R.current,[{opacity:0,transform:"translateY(-100px)",visibility:"hidden"},{opacity:1,transform:`translateY(${_})`,visibility:"visible"}],{duration:r,fill:"both",easing:e});w.current=new Animation(s,document.timeline)}),[u,R]),React.useEffect((()=>{w.current&&(u?(w.current.play(),w.current.onfinish=()=>{b(!0)}):(w.current.reverse(),b(!1)))}),[u]),React.useEffect((()=>{w.current&&(k===M?setTimeout((()=>{b(!0)}),100):b(!1))}),[k]),jsxRuntime.jsxs(jsxRuntime.Fragment,{children:["fullscreen"!==n&&jsxRuntime.jsx(Overlay,{open:u,onClick:()=>{p&&c&&c()},blur:d,color:m,opacity:y,closeOnClick:p}),jsxRuntime.jsx(react.FloatingPortal,{children:jsxRuntime.jsx("div",Object.assign({className:"flex justify-center"},{children:jsxRuntime.jsx("div",Object.assign({id:M,role:"dialog","aria-modal":"true","aria-hidden":!u,style:{opacity:0,visibility:"hidden"},ref:C,className:E},x,{children:t}))}))})]})}));_Modal.displayName="Modal";const Modal=Object.assign(_Modal,{Group:ModalGroup.ModalGroup});module.exports=Modal;
